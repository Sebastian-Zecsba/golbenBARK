{% schema %}
  {
    "name": "Productos Destacados",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Título de Sección",
        "default": "Colección Destacada"
      },
      {
        "type": "text",
        "id": "description",
        "label": "Descripción",
        "default": "Descubre nuestras piezas más exclusivas, creadas con los materiales más finos y diseñadas para perdurar en el tiempo."
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Texto del Botón",
        "default": "DESCUBRIR"
      },
      {
        "type": "text",
        "id": "secondary_button_text",
        "label": "Texto del Botón Secundario",
        "default": "VER"
      },
      {
        "type": "text",
        "id": "badge_featured",
        "label": "Texto Etiqueta Destacado",
        "default": "DESTACADO"
      },
      {
        "type": "color",
        "id": "badge_featured_color",
        "label": "Color Etiqueta Destacado",
        "default": "#D4AF37"
      },
      {
        "type": "color",
        "id": "overlay_color",
        "label": "Color de Superposición",
        "default": "#000000"
      }
    ],
    "blocks": [
      {
        "type": "featured_product",
        "name": "Producto Principal",
        "limit": 1,
        "settings": [
          {
            "type": "product",
            "id": "product",
            "label": "Producto"
          },
          {
            "type": "text",
            "id": "custom_title",
            "label": "Título Personalizado (Opcional)"
          },
          {
            "type": "textarea",
            "id": "custom_description",
            "label": "Descripción Personalizada (Opcional)"
          }
        ]
      },
      {
        "type": "product",
        "name": "Producto Secundario",
        "settings": [
          {
            "type": "product",
            "id": "product",
            "label": "Producto"
          },
          {
            "type": "text",
            "id": "custom_title",
            "label": "Título Personalizado (Opcional)"
          },
          {
            "type": "checkbox",
            "id": "show_discount",
            "label": "Mostrar etiqueta de descuento",
            "default": false
          },
          {
            "type": "text",
            "id": "discount_amount",
            "label": "Porcentaje de descuento",
            "default": "15"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Productos Destacados",
        "category": "Productos",
        "blocks": [
          {
            "type": "featured_product"
          },
          {
            "type": "product"
          },
          {
            "type": "product"
          },
          {
            "type": "product"
          }
        ]
      }
    ]
  }
  {% endschema %}
  
  <style>
  .featured-products {
    padding: 60px 0;
    font-family: var(--font-body-family);
  }
  
  .featured-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
  }
  
  .section-header {
    text-align: center;
    margin-bottom: 40px;
  }
  
  .section-title {
    font-family: var(--font-heading-family);
    font-size: calc(var(--font-heading-scale) * 3rem);
    font-weight: var(--font-heading-weight);
    margin-bottom: 15px;
    color: #1a1a1a;
  }
  
  .section-description {
    font-size: calc(var(--font-body-scale) * 1.25rem);
    line-height: 1.5;
    max-width: 700px;
    margin: 0 auto;
  }
  
  .products-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }
  
  .featured-product {
    position: relative;
    grid-column: 1;
    grid-row: 1 / span 2;
    border-radius: 0;
    overflow: hidden;
    height: 100%;
    min-height: 600px;
  }
  
  .secondary-products {
    grid-column: 2;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }
  
  .product-card {
    position: relative;
    overflow: hidden;
    border-radius: 0;
    background-color: #f5f5f5;
  }
  
  .product-card-content {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    padding: 30px;
    z-index: 3;
  }
  
  .featured-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
  }
  
  .product-image-container {
    position: relative;
    width: 100%;
    height: 100%;
    aspect-ratio: 1/1;
    overflow: hidden;
  }
  
  .product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.7s ease;
  }
  
  .product-card:hover .product-image {
    transform: scale(1.05);
  }
  
  .product-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.2) 50%, rgba(0,0,0,0) 100%);
    z-index: 2;
  }
  
  .product-badge {
    position: absolute;
    top: 20px;
    left: 20px;
    padding: 5px 10px;
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    z-index: 3;
    color: #000;
  }
  
  .discount-badge {
    position: absolute;
    top: 20px;
    right: 20px;
    padding: 5px 10px;
    background-color: #000;
    color: #fff;
    font-size: 14px;
    font-weight: 600;
    z-index: 3;
  }
  
  .product-title {
    font-family: var(--font-heading-family);
    font-size: calc(var(--font-heading-scale) * 2.2rem);
    font-weight: 500;
    margin-bottom: 5px;
    color: #fff;
  }
  
  .secondary-product-title {
    font-family: var(--font-heading-family);
    font-size: calc(var(--font-heading-scale) * 1.4rem);
    font-weight: 500;
    margin-bottom: 5px;
    color: #fff;
  }
  
  .product-description {
    font-size: 16px;
    line-height: 1.5;
    margin-bottom: 20px;
    color: #fff;
    max-width: 80%;
  }
  
  .product-price {
    font-weight: 600;
    font-size: 20px;
    color: #fff;
    margin-bottom: 20px;
  }
  
  .secondary-product-price {
    font-weight: 600;
    font-size: 18px;
    color: #fff;
  }
  
  .rating {
    display: flex;
    align-items: center;
    margin: 15px 0;
    color: #D4AF37;
  }
  
  .star {
    color: #D4AF37;
    margin-right: 2px;
  }
  
  .review-count {
    margin-left: 5px;
    font-size: 14px;
    color: #ddd;
  }
  
  .cta-button {
    display: inline-block;
    padding: 12px 30px;
    background-color: #D4AF37;
    color: #000;
    text-transform: uppercase;
    font-weight: 600;
    font-size: 14px;
    letter-spacing: 1px;
    text-decoration: none;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
  }
  
  .secondary-button {
    display: inline-block;
    padding: 8px 20px;
    background-color: transparent;
    color: #fff;
    border: 1px solid #fff;
    text-transform: uppercase;
    font-weight: 600;
    font-size: 12px;
    letter-spacing: 1px;
    text-decoration: none;
    transition: all 0.3s ease;
    cursor: pointer;
  }
  
  .cta-button:hover {
    background-color: #fff;
    color: #000;
  }
  
  .secondary-button:hover {
    background-color: #fff;
    color: #000;
  }
  
  @media screen and (max-width: 990px) {
    .products-grid {
      grid-template-columns: 1fr;
    }
  
    .featured-product {
      grid-row: auto;
      min-height: 450px;
    }
  
    .secondary-products {
      grid-column: 1;
      grid-template-columns: 1fr 1fr;
    }
  }
  
  @media screen and (max-width: 768px) {
    .section-title {
      font-size: calc(var(--font-heading-scale) * 2.5rem);
    }
  
    .featured-product {
      min-height: 400px;
    }
  
    .product-description {
      display: none;
    }
  }
  
  @media screen and (max-width: 640px) {
    .secondary-products {
      grid-template-columns: 1fr;
    }
  
    .product-title {
      font-size: calc(var(--font-heading-scale) * 1.8rem);
    }
  }
  </style>
  
  <section class="featured-products">
    <div class="featured-container">
      {% if section.settings.title != blank %}
        <div class="section-header">
          <h2 class="section-title">{{ section.settings.title }}</h2>
          {% if section.settings.description != blank %}
            <p class="section-description">{{ section.settings.description }}</p>
          {% endif %}
        </div>
      {% endif %}
  
      <div class="products-grid">
        {% assign featured_block = section.blocks | where: "type", "featured_product" | first %}
        {% if featured_block %}
          {% assign featured_product = all_products[featured_block.settings.product] %}
          {% if featured_product %}
            <div class="featured-product product-card" {{ featured_block.shopify_attributes }}>
              <a href="{{ featured_product.url }}" class="featured-image-container">
                <img 
                  src="{{ featured_product.featured_image | image_url: width: 800 }}" 
                  alt="{{ featured_product.title }}" 
                  class="product-image"
                  width="800"
                  height="800"
                  loading="lazy"
                >
                <div class="product-overlay"></div>
                {% if section.settings.badge_featured != blank %}
                  <span class="product-badge" style="background-color: {{ section.settings.badge_featured_color }};">
                    {{ section.settings.badge_featured }}
                  </span>
                {% endif %}
              </a>
  
              <div class="product-card-content">
                <h3 class="product-title">
                  {% if featured_block.settings.custom_title != blank %}
                    {{ featured_block.settings.custom_title }}
                  {% else %}
                    {{ featured_product.title }}
                  {% endif %}
                </h3>
  
                {% if featured_block.settings.custom_description != blank %}
                  <p class="product-description">{{ featured_block.settings.custom_description }}</p>
                {% endif %}
  
                <div class="rating">
                  {% for i in (1..5) %}
                    <span class="star">★</span>
                  {% endfor %}
                  <span class="review-count">(24)</span>
                </div>
  
                <p class="product-price">{{ featured_product.price | money_without_trailing_zeros }}</p>
  
                <a href="{{ featured_product.url }}" class="cta-button">
                  {{ section.settings.button_text }}
                </a>
              </div>
            </div>
          {% endif %}
        {% endif %}
  
        <div class="secondary-products">
          {% assign secondary_blocks = section.blocks | where: "type", "product" %}
          {% for block in secondary_blocks %}
            {% assign product = all_products[block.settings.product] %}
            {% if product %}
              <div class="product-card" {{ block.shopify_attributes }}>
                <a href="{{ product.url }}" class="product-image-container">
                  <img 
                    src="{{ product.featured_image | image_url: width: 500 }}" 
                    alt="{{ product.title }}" 
                    class="product-image"
                    width="500"
                    height="500"
                    loading="lazy"
                  >
                  <div class="product-overlay"></div>
                  {% if block.settings.show_discount and block.settings.discount_amount != blank %}
                    <span class="discount-badge">-{{ block.settings.discount_amount }}%</span>
                  {% endif %}
                </a>
  
                <div class="product-card-content">
                  <h3 class="secondary-product-title">
                    {% if block.settings.custom_title != blank %}
                      {{ block.settings.custom_title }}
                    {% else %}
                      {{ product.title }}
                    {% endif %}
                  </h3>
  
                  <p class="secondary-product-price">{{ product.price | money_without_trailing_zeros }}</p>
  
                  <a href="{{ product.url }}" class="secondary-button">
                    {{ section.settings.secondary_button_text }}
                  </a>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </section>